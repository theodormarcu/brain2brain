Running Scheduled Experiment.
tcn_m2o_noseq
/home/tmarcu/brain2brain/experiments/experiment_params/tcn_experiment_m2o_1_noseq.json
{'experiment_description': 'Experiment M2O TCN 1',
 'target_folder': 'tcn_experiment_m2o_1/',
 'path': '/home/tmarcu/brain2brain/brain2brain/train_676_bin_norm_files_projects.txt',
 'many_to_one': True,
 'batch_size': 1024,
 'epochs': 128,
 'lookback_window': 128,
 'length_pred': 1,
 'delay_pred': 0,
 'samples_per_second': 1,
 'electrode_selection': [0, 1, 2, 3, 4],
 'electrode_out': 2,
 'debug_mode': False,
 'num_feat': 1,
 'num_classes': 1,
 'nb_filters': 16,
 'kernel_size': 3,
 'dilations': [1, 2, 4, 8, 16],
 'nb_stacks': 2,
 'output_len': 1,
 'padding': 'causal',
 'use_skip_connections': True,
 'return_sequences': False,
 'regression': True,
 'dropout_rate': 0.05,
 'name': 'tcn',
 'kernel_initializer': 'he_normal',
 'activation': 'linear',
 'opt': 'RMSprop',
 'lr': 0.005,
 'loss': 'mae'}
(490, 114)
Train Generator Batch Shape:
Sample=(1024, 128, 5) Pred=(1024, 1, 1)
Validation Generator Batch Shape:
Sample=(1024, 128, 5) Pred=(1024, 1, 1)
(None, 128, 5)
2020-03-31 02:45:30.657041: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory
2020-03-31 02:45:30.657074: E tensorflow/stream_executor/cuda/cuda_driver.cc:318] failed call to cuInit: UNKNOWN ERROR (303)
2020-03-31 02:45:30.657102: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (tiger-i26c2n23): /proc/driver/nvidia/version does not exist
2020-03-31 02:45:30.657324: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2020-03-31 02:45:30.664594: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2400000000 Hz
2020-03-31 02:45:30.664720: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x562efd3c8970 executing computations on platform Host. Devices:
2020-03-31 02:45:30.664733: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): Host, Default Version
Model: "model"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 128, 5)]          0         
_________________________________________________________________
tcn (TCN)                    (None, 16)                18224     
_________________________________________________________________
dense (Dense)                (None, 1)                 17        
=================================================================
Total params: 18,241
Trainable params: 18,241
Non-trainable params: 0
_________________________________________________________________
calling compile
Epoch 1/128
 1/13 [=>............................] - ETA: 1:43 - loss: 20848.5078 2/13 [===>..........................] - ETA: 1:01 - loss: 17503.7451 3/13 [=====>........................] - ETA: 47s - loss: 14527.6416  4/13 [========>.....................] - ETA: 43s - loss: 12735.0765 5/13 [==========>...................] - ETA: 39s - loss: 11592.9395 6/13 [============>.................] - ETA: 33s - loss: 10689.1218 7/13 [===============>..............] - ETA: 27s - loss: 9961.9437  8/13 [=================>............] - ETA: 21s - loss: 9360.6200 9/13 [===================>..........] - ETA: 16s - loss: 8842.718410/13 [======================>.......] - ETA: 12s - loss: 8407.391611/13 [========================>.....] - ETA: 7s - loss: 8027.4767 12/13 [==========================>...] - ETA: 3s - loss: 7714.504413/13 [==============================] - 60s 5s/step - loss: 7411.7674 - val_loss: 2457.4775
Epoch 2/128
 1/13 [=>............................] - ETA: 30s - loss: 3504.2305 2/13 [===>..........................] - ETA: 27s - loss: 3338.8558 3/13 [=====>........................] - ETA: 24s - loss: 3257.9682 4/13 [========>.....................] - ETA: 21s - loss: 3178.9252 5/13 [==========>...................] - ETA: 18s - loss: 3081.4558 6/13 [============>.................] - ETA: 16s - loss: 2982.7775 7/13 [===============>..............] - ETA: 14s - loss: 2925.6951 8/13 [=================>............] - ETA: 11s - loss: 2848.6753 9/13 [===================>..........] - ETA: 9s - loss: 2787.1617 10/13 [======================>.......] - ETA: 6s - loss: 2716.918911/13 [========================>.....] - ETA: 4s - loss: 2656.506412/13 [==========================>...] - ETA: 2s - loss: 2587.905313/13 [==============================] - 35s 3s/step - loss: 2530.1016 - val_loss: 1209.5434
Epoch 3/128
 1/13 [=>............................] - ETA: 26s - loss: 1698.2075 2/13 [===>..........................] - ETA: 24s - loss: 1694.5085 3/13 [=====>........................] - ETA: 22s - loss: 1659.7931 4/13 [========>.....................] - ETA: 20s - loss: 1642.7344 5/13 [==========>...................] - ETA: 18s - loss: 1607.9140 6/13 [============>.................] - ETA: 16s - loss: 1582.6750 7/13 [===============>..............] - ETA: 13s - loss: 1549.6190 8/13 [=================>............] - ETA: 11s - loss: 1515.2400 9/13 [===================>..........] - ETA: 9s - loss: 1491.9130 10/13 [======================>.......] - ETA: 7s - loss: 1466.938411/13 [========================>.....] - ETA: 4s - loss: 1440.035812/13 [==========================>...] - ETA: 2s - loss: 1411.141913/13 [==============================] - 37s 3s/step - loss: 1387.0944 - val_loss: 687.9594
Epoch 4/128
 1/13 [=>............................] - ETA: 31s - loss: 1067.8535 2/13 [===>..........................] - ETA: 28s - loss: 1011.1320 3/13 [=====>........................] - ETA: 25s - loss: 990.2351  4/13 [========>.....................] - ETA: 22s - loss: 965.8334 5/13 [==========>...................] - ETA: 20s - loss: 952.2696 6/13 [============>.................] - ETA: 17s - loss: 928.8603 7/13 [===============>..............] - ETA: 14s - loss: 908.7013 8/13 [=================>............] - ETA: 12s - loss: 893.2008 9/13 [===================>..........] - ETA: 9s - loss: 874.6695 10/13 [======================>.......] - ETA: 7s - loss: 858.182211/13 [========================>.....] - ETA: 4s - loss: 840.583412/13 [==========================>...] - ETA: 2s - loss: 827.382413/13 [==============================] - 37s 3s/step - loss: 816.0406 - val_loss: 391.7637
Epoch 5/128
 1/13 [=>............................] - ETA: 31s - loss: 602.7736 2/13 [===>..........................] - ETA: 29s - loss: 598.3957 3/13 [=====>........................] - ETA: 26s - loss: 602.0735 4/13 [========>.....................] - ETA: 23s - loss: 589.3130 5/13 [==========>...................] - ETA: 20s - loss: 573.0642 6/13 [============>.................] - ETA: 17s - loss: 567.1819 7/13 [===============>..............] - ETA: 15s - loss: 559.5624 8/13 [=================>............] - ETA: 12s - loss: 552.9089 9/13 [===================>..........] - ETA: 10s - loss: 542.576810/13 [======================>.......] - ETA: 7s - loss: 531.0308 11/13 [========================>.....] - ETA: 4s - loss: 521.818212/13 [==========================>...] - ETA: 2s - loss: 511.889613/13 [==============================] - 38s 3s/step - loss: 503.2482 - val_loss: 259.0740
Epoch 6/128
 1/13 [=>............................] - ETA: 30s - loss: 401.8560 2/13 [===>..........................] - ETA: 28s - loss: 385.0768 3/13 [=====>........................] - ETA: 25s - loss: 374.6074 4/13 [========>.....................] - ETA: 22s - loss: 373.1979 5/13 [==========>...................] - ETA: 19s - loss: 366.7288 6/13 [============>.................] - ETA: 17s - loss: 360.1525 7/13 [===============>..............] - ETA: 14s - loss: 354.3780 8/13 [=================>............] - ETA: 12s - loss: 350.6805 9/13 [===================>..........] - ETA: 9s - loss: 346.2598 10/13 [======================>.......] - ETA: 7s - loss: 343.049211/13 [========================>.....] - ETA: 4s - loss: 338.750212/13 [==========================>...] - ETA: 2s - loss: 334.144813/13 [==============================] - 37s 3s/step - loss: 329.6524 - val_loss: 183.3685
Epoch 7/128
 1/13 [=>............................] - ETA: 31s - loss: 256.9572 2/13 [===>..........................] - ETA: 28s - loss: 246.7622 3/13 [=====>........................] - ETA: 25s - loss: 255.8860 4/13 [========>.....................] - ETA: 22s - loss: 254.2184 5/13 [==========>...................] - ETA: 19s - loss: 252.5114 6/13 [============>.................] - ETA: 17s - loss: 248.5505 7/13 [===============>..............] - ETA: 14s - loss: 246.4201 8/13 [=================>............] - ETA: 12s - loss: 244.9341 9/13 [===================>..........] - ETA: 9s - loss: 241.7134 10/13 [======================>.......] - ETA: 7s - loss: 237.835111/13 [========================>.....] - ETA: 4s - loss: 235.264712/13 [==========================>...] - ETA: 2s - loss: 231.647813/13 [==============================] - 38s 3s/step - loss: 228.1672 - val_loss: 138.0493
Epoch 8/128
 1/13 [=>............................] - ETA: 32s - loss: 191.0101 2/13 [===>..........................] - ETA: 29s - loss: 192.3962 3/13 [=====>........................] - ETA: 25s - loss: 187.0669 4/13 [========>.....................] - ETA: 22s - loss: 184.1455 5/13 [==========>...................] - ETA: 20s - loss: 184.0921 6/13 [============>.................] - ETA: 17s - loss: 183.3645 7/13 [===============>..............] - ETA: 14s - loss: 180.0891 8/13 [=================>............] - ETA: 12s - loss: 177.1215 9/13 [===================>..........] - ETA: 9s - loss: 174.4204 10/13 [======================>.......] - ETA: 7s - loss: 171.252611/13 [========================>.....] - ETA: 4s - loss: 168.851012/13 [==========================>...] - ETA: 2s - loss: 167.473113/13 [==============================] - 38s 3s/step - loss: 166.0040 - val_loss: 104.5497
Epoch 9/128
 1/13 [=>............................] - ETA: 31s - loss: 130.6300 2/13 [===>..........................] - ETA: 28s - loss: 132.9090 3/13 [=====>........................] - ETA: 25s - loss: 133.5153 4/13 [========>.....................] - ETA: 22s - loss: 132.0238 5/13 [==========>...................] - ETA: 20s - loss: 130.3477 6/13 [============>.................] - ETA: 17s - loss: 129.4059 7/13 [===============>..............] - ETA: 15s - loss: 129.1733 8/13 [=================>............] - ETA: 12s - loss: 128.7400 9/13 [===================>..........] - ETA: 9s - loss: 127.5628 10/13 [======================>.......] - ETA: 7s - loss: 126.679611/13 [========================>.....] - ETA: 4s - loss: 126.215612/13 [==========================>...] - ETA: 2s - loss: 125.687613/13 [==============================] - 37s 3s/step - loss: 125.0452 - val_loss: 87.8992
Epoch 10/128
 1/13 [=>............................] - ETA: 31s - loss: 117.7325 2/13 [===>..........................] - ETA: 29s - loss: 113.4181 3/13 [=====>........................] - ETA: 25s - loss: 110.7536 4/13 [========>.....................] - ETA: 23s - loss: 107.9523 5/13 [==========>...................] - ETA: 20s - loss: 106.6146 6/13 [============>.................] - ETA: 17s - loss: 105.1266 7/13 [===============>..............] - ETA: 15s - loss: 103.3215 8/13 [=================>............] - ETA: 12s - loss: 102.5664 9/13 [===================>..........] - ETA: 9s - loss: 101.7788 10/13 [======================>.......] - ETA: 7s - loss: 101.094011/13 [========================>.....] - ETA: 4s - loss: 100.489912/13 [==========================>...] - ETA: 2s - loss: 99.5622 13/13 [==============================] - 38s 3s/step - loss: 98.5426 - val_loss: 71.5592
Epoch 11/128
 1/13 [=>............................] - ETA: 32s - loss: 90.0944 2/13 [===>..........................] - ETA: 29s - loss: 91.5204 3/13 [=====>........................] - ETA: 26s - loss: 93.0214 4/13 [========>.....................] - ETA: 23s - loss: 90.8120 5/13 [==========>...................] - ETA: 20s - loss: 89.5638 6/13 [============>.................] - ETA: 17s - loss: 88.1491 7/13 [===============>..............] - ETA: 15s - loss: 86.9799 8/13 [=================>............] - ETA: 12s - loss: 86.1284 9/13 [===================>..........] - ETA: 9s - loss: 85.2647 10/13 [======================>.......] - ETA: 7s - loss: 84.093811/13 [========================>.....] - ETA: 4s - loss: 83.389412/13 [==========================>...] - ETA: 2s - loss: 82.895413/13 [==============================] - 38s 3s/step - loss: 82.2715 - val_loss: 64.7869
Epoch 12/128
 1/13 [=>............................] - ETA: 31s - loss: 71.0961 2/13 [===>..........................] - ETA: 29s - loss: 72.1542 3/13 [=====>........................] - ETA: 25s - loss: 71.4507 4/13 [========>.....................] - ETA: 23s - loss: 71.0107 5/13 [==========>...................] - ETA: 20s - loss: 71.1064 6/13 [============>.................] - ETA: 17s - loss: 71.0941 7/13 [===============>..............] - ETA: 15s - loss: 71.4184 8/13 [=================>............] - ETA: 12s - loss: 71.5254 9/13 [===================>..........] - ETA: 10s - loss: 71.567210/13 [======================>.......] - ETA: 7s - loss: 70.9601 11/13 [========================>.....] - ETA: 4s - loss: 70.388312/13 [==========================>...] - ETA: 2s - loss: 70.250413/13 [==============================] - 38s 3s/step - loss: 70.0419 - val_loss: 56.8064
Epoch 13/128
 1/13 [=>............................] - ETA: 30s - loss: 64.0855 2/13 [===>..........................] - ETA: 28s - loss: 63.9126 3/13 [=====>........................] - ETA: 25s - loss: 64.9436 4/13 [========>.....................] - ETA: 22s - loss: 65.1254 5/13 [==========>...................] - ETA: 20s - loss: 64.7201 6/13 [============>.................] - ETA: 17s - loss: 64.9551 7/13 [===============>..............] - ETA: 14s - loss: 64.5631 8/13 [=================>............] - ETA: 12s - loss: 64.0582 9/13 [===================>..........] - ETA: 9s - loss: 63.9172 10/13 [======================>.......] - ETA: 7s - loss: 63.619411/13 [========================>.....] - ETA: 4s - loss: 63.614412/13 [==========================>...] - ETA: 2s - loss: 63.688213/13 [==============================] - 38s 3s/step - loss: 63.4070 - val_loss: 54.7516
Epoch 14/128
 1/13 [=>............................] - ETA: 30s - loss: nan 2/13 [===>..........................] - ETA: 28s - loss: nan 3/13 [=====>........................] - ETA: 25s - loss: nan 4/13 [========>.....................] - ETA: 22s - loss: nan 5/13 [==========>...................] - ETA: 20s - loss: nan 6/13 [============>.................] - ETA: 17s - loss: nan 7/13 [===============>..............] - ETA: 14s - loss: nan 8/13 [=================>............] - ETA: 12s - loss: nan 9/13 [===================>..........] - ETA: 9s - loss: nan 10/13 [======================>.......] - ETA: 7s - loss: nan11/13 [========================>.....] - ETA: 4s - loss: nan12/13 [==========================>...] - ETA: 2s - loss: nan13/13 [==============================] - 38s 3s/step - loss: nan - val_loss: nan
Epoch 15/128
 1/13 [=>............................] - ETA: 31s - loss: nan 2/13 [===>..........................] - ETA: 29s - loss: nan 3/13 [=====>........................] - ETA: 25s - loss: nan 4/13 [========>.....................] - ETA: 22s - loss: nan 5/13 [==========>...................] - ETA: 20s - loss: nan 6/13 [============>.................] - ETA: 17s - loss: nan 7/13 [===============>..............] - ETA: 14s - loss: nan 8/13 [=================>............] - ETA: 12s - loss: nan 9/13 [===================>..........] - ETA: 9s - loss: nan 10/13 [======================>.......] - ETA: 7s - loss: nan11/13 [========================>.....] - ETA: 4s - loss: nan12/13 [==========================>...] - ETA: 2s - loss: nan13/13 [==============================] - 37s 3s/step - loss: nan - val_loss: nan
Epoch 16/128
 1/13 [=>............................] - ETA: 32s - loss: nan 2/13 [===>..........................] - ETA: 28s - loss: nan 3/13 [=====>........................] - ETA: 25s - loss: nan 4/13 [========>.....................] - ETA: 22s - loss: nan 5/13 [==========>...................] - ETA: 20s - loss: nan 6/13 [============>.................] - ETA: 17s - loss: nan 7/13 [===============>..............] - ETA: 15s - loss: nan 8/13 [=================>............] - ETA: 12s - loss: nan 9/13 [===================>..........] - ETA: 9s - loss: nan 10/13 [======================>.......] - ETA: 7s - loss: nan11/13 [========================>.....] - ETA: 4s - loss: nan12/13 [==========================>...] - ETA: 2s - loss: nan13/13 [==============================] - 38s 3s/step - loss: nan - val_loss: nan
1/3 [=========>....................] - ETA: 3s2/3 [===================>..........] - ETA: 1s3/3 [==============================] - 5s 2s/step
Traceback (most recent call last):
  File "/home/tmarcu/.conda/envs/brain2brain_env/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/home/tmarcu/.conda/envs/brain2brain_env/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/tmarcu/brain2brain/brain2brain/__main__.py", line 57, in <module>
    raise Exception(f"Experiment {experiment_name} does not exist! Aborting.")
  File "/home/tmarcu/brain2brain/brain2brain/__main__.py", line 43, in main
    tcn_experiments.tcn_m2o_noseq(experiment_params)
  File "/home/tmarcu/brain2brain/brain2brain/tcn_experiments.py", line 675, in tcn_m2o_noseq
    plt.plot(p)
NameError: name 'p' is not defined
