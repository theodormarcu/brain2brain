Running Scheduled Experiment.
tcn_m2o_noseq
/home/tmarcu/brain2brain/experiments/experiment_params/tcn_experiment_m2o_3_noseq.json
{'experiment_description': 'Experiment M2O TCN 3',
 'target_folder': 'tcn_experiment_m2o_3/',
 'path': '/home/tmarcu/brain2brain/brain2brain/train_676_bin_norm_files_projects.txt',
 'many_to_one': True,
 'batch_size': 512,
 'epochs': 256,
 'lookback_window': 256,
 'length_pred': 1,
 'delay_pred': 0,
 'samples_per_second': 1,
 'electrode_selection': [0, 1, 2, 3, 4],
 'electrode_out': 2,
 'debug_mode': False,
 'num_feat': 1,
 'num_classes': 1,
 'nb_filters': 16,
 'kernel_size': 3,
 'dilations': [1, 2, 4, 8, 16],
 'nb_stacks': 2,
 'output_len': 1,
 'padding': 'causal',
 'use_skip_connections': True,
 'return_sequences': False,
 'regression': True,
 'dropout_rate': 0.05,
 'name': 'tcn',
 'kernel_initializer': 'he_normal',
 'activation': 'linear',
 'opt': 'RMSprop',
 'lr': 0.005,
 'loss': 'mae'}
(490, 114)
Train Generator Batch Shape:
Sample=(512, 256, 5) Pred=(512, 1, 1)
Validation Generator Batch Shape:
Sample=(512, 256, 5) Pred=(512, 1, 1)
(None, 256, 5)
2020-03-31 02:51:07.861125: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory
2020-03-31 02:51:07.861159: E tensorflow/stream_executor/cuda/cuda_driver.cc:318] failed call to cuInit: UNKNOWN ERROR (303)
2020-03-31 02:51:07.861188: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (tiger-i26c2n17): /proc/driver/nvidia/version does not exist
2020-03-31 02:51:07.861407: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2020-03-31 02:51:07.868500: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2400000000 Hz
2020-03-31 02:51:07.868628: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55d008134970 executing computations on platform Host. Devices:
2020-03-31 02:51:07.868640: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): Host, Default Version
Model: "model"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 256, 5)]          0         
_________________________________________________________________
tcn (TCN)                    (None, 16)                18224     
_________________________________________________________________
dense (Dense)                (None, 1)                 17        
=================================================================
Total params: 18,241
Trainable params: 18,241
Non-trainable params: 0
_________________________________________________________________
calling compile
Epoch 1/256
 1/13 [=>............................] - ETA: 55s - loss: 18046.1191 2/13 [===>..........................] - ETA: 39s - loss: 13475.3594 3/13 [=====>........................] - ETA: 32s - loss: 10831.0887 4/13 [========>.....................] - ETA: 28s - loss: 9136.8043  5/13 [==========>...................] - ETA: 24s - loss: 8033.7633 6/13 [============>.................] - ETA: 20s - loss: 7254.5090 7/13 [===============>..............] - ETA: 17s - loss: 6643.8842 8/13 [=================>............] - ETA: 14s - loss: 6194.3582 9/13 [===================>..........] - ETA: 10s - loss: 5789.726210/13 [======================>.......] - ETA: 8s - loss: 5452.8504 11/13 [========================>.....] - ETA: 5s - loss: 5177.694612/13 [==========================>...] - ETA: 2s - loss: 4925.863613/13 [==============================] - 40s 3s/step - loss: 4714.6960 - val_loss: 1390.3686
Epoch 2/256
 1/13 [=>............................] - ETA: 29s - loss: 1972.5767 2/13 [===>..........................] - ETA: 27s - loss: 1902.1697 3/13 [=====>........................] - ETA: 24s - loss: 1877.0682 4/13 [========>.....................] - ETA: 21s - loss: 1872.1585 5/13 [==========>...................] - ETA: 19s - loss: 1847.3458 6/13 [============>.................] - ETA: 16s - loss: 1807.0503 7/13 [===============>..............] - ETA: 14s - loss: 1771.1594 8/13 [=================>............] - ETA: 11s - loss: 1735.0625 9/13 [===================>..........] - ETA: 9s - loss: 1706.3998 10/13 [======================>.......] - ETA: 7s - loss: 1671.211311/13 [========================>.....] - ETA: 4s - loss: 1638.611212/13 [==========================>...] - ETA: 2s - loss: 1606.373513/13 [==============================] - 35s 3s/step - loss: 1578.1663 - val_loss: 725.9745
Epoch 3/256
 1/13 [=>............................] - ETA: 30s - loss: 1064.7141 2/13 [===>..........................] - ETA: 27s - loss: 1102.7692 3/13 [=====>........................] - ETA: 24s - loss: 1100.7328 4/13 [========>.....................] - ETA: 21s - loss: 1091.0722 5/13 [==========>...................] - ETA: 19s - loss: 1075.6670 6/13 [============>.................] - ETA: 16s - loss: 1045.8733 7/13 [===============>..............] - ETA: 14s - loss: 1031.3831 8/13 [=================>............] - ETA: 11s - loss: 1015.2259 9/13 [===================>..........] - ETA: 9s - loss: 999.8069  10/13 [======================>.......] - ETA: 7s - loss: 986.221311/13 [========================>.....] - ETA: 4s - loss: 971.796812/13 [==========================>...] - ETA: 2s - loss: 955.221313/13 [==============================] - 35s 3s/step - loss: 936.9401 - val_loss: 478.2493
Epoch 4/256
 1/13 [=>............................] - ETA: 31s - loss: 716.5995 2/13 [===>..........................] - ETA: 27s - loss: 710.8201 3/13 [=====>........................] - ETA: 24s - loss: 699.0694 4/13 [========>.....................] - ETA: 21s - loss: 688.3034 5/13 [==========>...................] - ETA: 19s - loss: 675.7867 6/13 [============>.................] - ETA: 16s - loss: 671.2241 7/13 [===============>..............] - ETA: 14s - loss: 659.2191 8/13 [=================>............] - ETA: 12s - loss: 649.5122 9/13 [===================>..........] - ETA: 9s - loss: 644.7134 10/13 [======================>.......] - ETA: 7s - loss: 631.794111/13 [========================>.....] - ETA: 4s - loss: 623.448712/13 [==========================>...] - ETA: 2s - loss: 613.187213/13 [==============================] - 35s 3s/step - loss: 604.9804 - val_loss: 321.5215
Epoch 5/256
 1/13 [=>............................] - ETA: 30s - loss: 475.4435 2/13 [===>..........................] - ETA: 27s - loss: 480.0545 3/13 [=====>........................] - ETA: 24s - loss: 470.4895 4/13 [========>.....................] - ETA: 21s - loss: 459.8963 5/13 [==========>...................] - ETA: 19s - loss: 456.6093 6/13 [============>.................] - ETA: 16s - loss: 449.5480 7/13 [===============>..............] - ETA: 14s - loss: 443.3496 8/13 [=================>............] - ETA: 11s - loss: 435.0429 9/13 [===================>..........] - ETA: 9s - loss: 430.2616 10/13 [======================>.......] - ETA: 7s - loss: 425.309311/13 [========================>.....] - ETA: 4s - loss: 419.220012/13 [==========================>...] - ETA: 2s - loss: 413.143513/13 [==============================] - 35s 3s/step - loss: 408.5153 - val_loss: 224.4748
Epoch 6/256
 1/13 [=>............................] - ETA: 30s - loss: 337.0795 2/13 [===>..........................] - ETA: 27s - loss: 323.3763 3/13 [=====>........................] - ETA: 24s - loss: 324.4039 4/13 [========>.....................] - ETA: 21s - loss: 313.0565 5/13 [==========>...................] - ETA: 19s - loss: 309.5319 6/13 [============>.................] - ETA: 16s - loss: 306.6050 7/13 [===============>..............] - ETA: 14s - loss: 303.4473 8/13 [=================>............] - ETA: 12s - loss: 298.0936 9/13 [===================>..........] - ETA: 9s - loss: 293.3546 10/13 [======================>.......] - ETA: 7s - loss: 291.527111/13 [========================>.....] - ETA: 4s - loss: 287.722612/13 [==========================>...] - ETA: 2s - loss: 283.462913/13 [==============================] - 35s 3s/step - loss: 278.9644 - val_loss: 157.8976
Epoch 7/256
 1/13 [=>............................] - ETA: 30s - loss: 226.0895 2/13 [===>..........................] - ETA: 27s - loss: 222.3544 3/13 [=====>........................] - ETA: 24s - loss: 219.8599 4/13 [========>.....................] - ETA: 21s - loss: 216.5210 5/13 [==========>...................] - ETA: 19s - loss: 212.5141 6/13 [============>.................] - ETA: 16s - loss: 207.9317 7/13 [===============>..............] - ETA: 14s - loss: 204.1731 8/13 [=================>............] - ETA: 11s - loss: 200.0049 9/13 [===================>..........] - ETA: 9s - loss: 196.5384 10/13 [======================>.......] - ETA: 7s - loss: 195.265711/13 [========================>.....] - ETA: 4s - loss: 193.085312/13 [==========================>...] - ETA: 2s - loss: 190.530013/13 [==============================] - 35s 3s/step - loss: 187.5610 - val_loss: 117.0689
Epoch 8/256
 1/13 [=>............................] - ETA: 30s - loss: 164.9692 2/13 [===>..........................] - ETA: 27s - loss: 160.6557 3/13 [=====>........................] - ETA: 24s - loss: 156.5447 4/13 [========>.....................] - ETA: 21s - loss: 154.9033 5/13 [==========>...................] - ETA: 19s - loss: 152.3305 6/13 [============>.................] - ETA: 16s - loss: 151.8527 7/13 [===============>..............] - ETA: 14s - loss: 149.8578 8/13 [=================>............] - ETA: 11s - loss: 147.2937 9/13 [===================>..........] - ETA: 9s - loss: 145.3492 10/13 [======================>.......] - ETA: 7s - loss: 143.246311/13 [========================>.....] - ETA: 4s - loss: 139.978812/13 [==========================>...] - ETA: 2s - loss: 139.245713/13 [==============================] - 35s 3s/step - loss: 138.3318 - val_loss: 86.9123
Epoch 9/256
 1/13 [=>............................] - ETA: 31s - loss: 118.1128 2/13 [===>..........................] - ETA: 27s - loss: 117.6267 3/13 [=====>........................] - ETA: 24s - loss: 113.9418 4/13 [========>.....................] - ETA: 21s - loss: 112.2572 5/13 [==========>...................] - ETA: 19s - loss: 112.1562 6/13 [============>.................] - ETA: 16s - loss: 110.7395 7/13 [===============>..............] - ETA: 14s - loss: 110.6017 8/13 [=================>............] - ETA: 11s - loss: 109.7012 9/13 [===================>..........] - ETA: 9s - loss: 108.6602 10/13 [======================>.......] - ETA: 7s - loss: 107.806211/13 [========================>.....] - ETA: 4s - loss: 107.269012/13 [==========================>...] - ETA: 2s - loss: 106.743113/13 [==============================] - 35s 3s/step - loss: 106.0826 - val_loss: 71.6350
Epoch 10/256
 1/13 [=>............................] - ETA: 30s - loss: 89.8018 2/13 [===>..........................] - ETA: 27s - loss: 91.0954 3/13 [=====>........................] - ETA: 24s - loss: 91.5892 4/13 [========>.....................] - ETA: 21s - loss: 90.8647 5/13 [==========>...................] - ETA: 19s - loss: 90.0273 6/13 [============>.................] - ETA: 16s - loss: 88.6301 7/13 [===============>..............] - ETA: 14s - loss: 87.6300 8/13 [=================>............] - ETA: 11s - loss: 87.4282 9/13 [===================>..........] - ETA: 9s - loss: 86.3419 10/13 [======================>.......] - ETA: 7s - loss: 85.115311/13 [========================>.....] - ETA: 4s - loss: 84.485312/13 [==========================>...] - ETA: 2s - loss: 84.019613/13 [==============================] - 35s 3s/step - loss: 83.3169 - val_loss: 62.6844
Epoch 11/256
 1/13 [=>............................] - ETA: 30s - loss: 74.4359 2/13 [===>..........................] - ETA: 27s - loss: 74.1003 3/13 [=====>........................] - ETA: 24s - loss: 75.4636 4/13 [========>.....................] - ETA: 21s - loss: 73.8793 5/13 [==========>...................] - ETA: 19s - loss: 74.0779 6/13 [============>.................] - ETA: 16s - loss: 73.6896 7/13 [===============>..............] - ETA: 14s - loss: 73.9325 8/13 [=================>............] - ETA: 11s - loss: 72.8972 9/13 [===================>..........] - ETA: 9s - loss: 72.2691 10/13 [======================>.......] - ETA: 7s - loss: 71.732311/13 [========================>.....] - ETA: 4s - loss: 71.338912/13 [==========================>...] - ETA: 2s - loss: 71.145113/13 [==============================] - 35s 3s/step - loss: 70.6965 - val_loss: 55.2457
Epoch 12/256
 1/13 [=>............................] - ETA: 30s - loss: 65.9166 2/13 [===>..........................] - ETA: 27s - loss: 66.2062 3/13 [=====>........................] - ETA: 24s - loss: 65.8815 4/13 [========>.....................] - ETA: 21s - loss: 65.0653 5/13 [==========>...................] - ETA: 19s - loss: 64.5017 6/13 [============>.................] - ETA: 16s - loss: 64.1967 7/13 [===============>..............] - ETA: 14s - loss: 63.6119 8/13 [=================>............] - ETA: 11s - loss: 63.1469 9/13 [===================>..........] - ETA: 9s - loss: 62.5857 10/13 [======================>.......] - ETA: 7s - loss: 62.514611/13 [========================>.....] - ETA: 4s - loss: 62.512112/13 [==========================>...] - ETA: 2s - loss: 62.483013/13 [==============================] - 35s 3s/step - loss: 62.3380 - val_loss: 50.7731
Epoch 13/256
 1/13 [=>............................] - ETA: 29s - loss: 59.6405 2/13 [===>..........................] - ETA: 27s - loss: 59.1146 3/13 [=====>........................] - ETA: 24s - loss: 58.5629 4/13 [========>.....................] - ETA: 21s - loss: 58.5540 5/13 [==========>...................] - ETA: 19s - loss: 58.4330 6/13 [============>.................] - ETA: 16s - loss: 57.5068 7/13 [===============>..............] - ETA: 14s - loss: 57.0047 8/13 [=================>............] - ETA: 11s - loss: 57.0005 9/13 [===================>..........] - ETA: 9s - loss: 56.5805 10/13 [======================>.......] - ETA: 7s - loss: 56.174611/13 [========================>.....] - ETA: 4s - loss: 56.077612/13 [==========================>...] - ETA: 2s - loss: 55.575213/13 [==============================] - 35s 3s/step - loss: 55.4524 - val_loss: 48.3812
Epoch 14/256
 1/13 [=>............................] - ETA: 28s - loss: 55.6903 2/13 [===>..........................] - ETA: 26s - loss: 53.5014 3/13 [=====>........................] - ETA: 23s - loss: 52.9222 4/13 [========>.....................] - ETA: 21s - loss: 53.9348 5/13 [==========>...................] - ETA: 18s - loss: 53.5598 6/13 [============>.................] - ETA: 16s - loss: 53.5857 7/13 [===============>..............] - ETA: 14s - loss: 53.5153 8/13 [=================>............] - ETA: 11s - loss: 53.2788 9/13 [===================>..........] - ETA: 9s - loss: 52.9599 10/13 [======================>.......] - ETA: 7s - loss: 52.742511/13 [========================>.....] - ETA: 4s - loss: 293694036651707.562512/13 [==========================>...] - ETA: 2s - loss: 269219533597402.968813/13 [==============================] - 35s 3s/step - loss: 248510338705299.0000 - val_loss: 48.0904
Epoch 15/256
 1/13 [=>............................] - ETA: 30s - loss: 51.9473 2/13 [===>..........................] - ETA: 27s - loss: 50.7321 3/13 [=====>........................] - ETA: 24s - loss: 50.4446 4/13 [========>.....................] - ETA: 21s - loss: 50.6984 5/13 [==========>...................] - ETA: 19s - loss: 51.0158 6/13 [============>.................] - ETA: 16s - loss: 51.2908 7/13 [===============>..............] - ETA: 14s - loss: 51.7685 8/13 [=================>............] - ETA: 11s - loss: 51.8996 9/13 [===================>..........] - ETA: 9s - loss: 51.7880 10/13 [======================>.......] - ETA: 7s - loss: 51.762611/13 [========================>.....] - ETA: 4s - loss: 51.646012/13 [==========================>...] - ETA: 2s - loss: 51.750913/13 [==============================] - 35s 3s/step - loss: 51.7688 - val_loss: 47.9487
Epoch 16/256
 1/13 [=>............................] - ETA: 30s - loss: 50.0578 2/13 [===>..........................] - ETA: 27s - loss: 49.8916 3/13 [=====>........................] - ETA: 24s - loss: 51.4559 4/13 [========>.....................] - ETA: 21s - loss: 52.1281 5/13 [==========>...................] - ETA: 19s - loss: 51.6389 6/13 [============>.................] - ETA: 16s - loss: 52.0146 7/13 [===============>..............] - ETA: 14s - loss: 51.8978 8/13 [=================>............] - ETA: 11s - loss: 52.2262 9/13 [===================>..........] - ETA: 9s - loss: 52.3403 10/13 [======================>.......] - ETA: 7s - loss: 52.453111/13 [========================>.....] - ETA: 4s - loss: 5079815374337.139612/13 [==========================>...] - ETA: 2s - loss: 4656497426479.893613/13 [==============================] - 35s 3s/step - loss: 4298305316754.5811 - val_loss: 48.1849
Epoch 17/256
 1/13 [=>............................] - ETA: 30s - loss: 49.3514 2/13 [===>..........................] - ETA: 27s - loss: 49.5355 3/13 [=====>........................] - ETA: 24s - loss: 50.7601 4/13 [========>.....................] - ETA: 21s - loss: 50.5962 5/13 [==========>...................] - ETA: 19s - loss: 50.8392 6/13 [============>.................] - ETA: 16s - loss: 51.3311 7/13 [===============>..............] - ETA: 14s - loss: 51.5805 8/13 [=================>............] - ETA: 11s - loss: 51.3029 9/13 [===================>..........] - ETA: 9s - loss: 51.2456 10/13 [======================>.......] - ETA: 7s - loss: 51.593811/13 [========================>.....] - ETA: 4s - loss: 19600443202886.175812/13 [==========================>...] - ETA: 2s - loss: 17967072935983.265613/13 [==============================] - 35s 3s/step - loss: 16584990402450.0586 - val_loss: 48.3287
Epoch 18/256
 1/13 [=>............................] - ETA: 28s - loss: 50.3807 2/13 [===>..........................] - ETA: 26s - loss: 51.1332 3/13 [=====>........................] - ETA: 23s - loss: 51.8017 4/13 [========>.....................] - ETA: 21s - loss: 51.0444 5/13 [==========>...................] - ETA: 19s - loss: 51.3873 6/13 [============>.................] - ETA: 16s - loss: 51.2227 7/13 [===============>..............] - ETA: 14s - loss: 51.8084 8/13 [=================>............] - ETA: 11s - loss: 52.0655 9/13 [===================>..........] - ETA: 9s - loss: 51.8251 10/13 [======================>.......] - ETA: 7s - loss: 51.571011/13 [========================>.....] - ETA: 4s - loss: 13212487706857.064512/13 [==========================>...] - ETA: 2s - loss: 12111447064623.396513/13 [==============================] - 35s 3s/step - loss: 11179797290425.5566 - val_loss: 48.4322
1/3 [=========>....................] - ETA: 2s2/3 [===================>..........] - ETA: 1s3/3 [==============================] - 4s 1s/step
Traceback (most recent call last):
  File "/home/tmarcu/.conda/envs/brain2brain_env/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/home/tmarcu/.conda/envs/brain2brain_env/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/tmarcu/brain2brain/brain2brain/__main__.py", line 57, in <module>
    raise Exception(f"Experiment {experiment_name} does not exist! Aborting.")
  File "/home/tmarcu/brain2brain/brain2brain/__main__.py", line 43, in main
    tcn_experiments.tcn_m2o_noseq(experiment_params)
  File "/home/tmarcu/brain2brain/brain2brain/tcn_experiments.py", line 675, in tcn_m2o_noseq
    plt.plot(p)
NameError: name 'p' is not defined
