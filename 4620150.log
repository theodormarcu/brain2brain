Running Scheduled Experiment.
tcn_m2o_seq
experiments/experiment_params/tcn_m2o_norm_seq_2.json
tcn_m2o_norm_seq_2
{'experiment_name': 'tcn_m2o_norm_seq_2',
 'experiment_description': 'Experiment M2O TCN 2 - Normalized Data',
 'target_folder': 'tcn_m2o_norm_seq_2/',
 'path': '/home/tmarcu/brain2brain/brain2brain/train_676_norm_files_projects.txt',
 'batch_size': 1024,
 'epochs': 128,
 'lookback_window': 128,
 'length_pred': 25,
 'delay_pred': 0,
 'samples_per_second': 1,
 'electrode_selection': [0, 1, 2, 3, 4],
 'electrode_out': 2,
 'num_feat': 1,
 'num_classes': 1,
 'nb_filters': 16,
 'kernel_size': 3,
 'dilations': [1, 2, 4, 8],
 'nb_stacks': 2,
 'output_len': 1,
 'padding': 'causal',
 'use_skip_connections': True,
 'return_sequences': True,
 'regression': True,
 'dropout_rate': 0.1,
 'name': 'tcn',
 'kernel_initializer': 'he_normal',
 'activation': 'linear',
 'opt': 'RMSprop',
 'lr': 0.005,
 'loss': 'mae',
 'debug_mode': False}
wandb: Dry run mode, not syncing to the cloud.
wandb: Tracking run with wandb version 0.8.31
wandb: Run data is saved locally in tcn_m2o_norm_seq_2/wandb/dryrun-20200414_162145-34vmptsx

(36853, 114)
Train Generator Batch Shape:
Sample=(1024, 128, 5) Pred=(1024, 25)
Validation Generator Batch Shape:
Sample=(1024, 128, 5) Pred=(1024, 25)
(None, 128, 5)
2020-04-14 12:24:26.075786: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory
2020-04-14 12:24:26.075825: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-04-14 12:24:26.075847: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (tiger-i26c2n8): /proc/driver/nvidia/version does not exist
2020-04-14 12:24:26.076165: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2020-04-14 12:24:26.083724: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2400000000 Hz
2020-04-14 12:24:26.083926: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x559e3e3da080 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-04-14 12:24:26.083942: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
calling compile
Model: "model"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 128, 5)]          0         
_________________________________________________________________
tcn (TCN)                    (None, 128, 16)           14544     
_________________________________________________________________
dense (Dense)                (None, 128, 1)            17        
_________________________________________________________________
lambda (Lambda)              (None, 25, 1)             0         
=================================================================
Total params: 14,561
Trainable params: 14,561
Non-trainable params: 0
_________________________________________________________________
WARNING:tensorflow:From /home/tmarcu/brain2brain/brain2brain/tcn_experiments.py:803: Model.fit_generator (from tensorflow.python.keras.engine.training) is deprecated and will be removed in a future version.
Instructions for updating:
Please use Model.fit, which supports generators.
WARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
WARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
Train for 255 steps, validate for 86 steps
Epoch 1/128
  1/255 [..............................] - ETA: 27:37 - loss: 72.1606  2/255 [..............................] - ETA: 5:49:32 - loss: 52.8055  3/255 [..............................] - ETA: 3:56:25 - loss: 42.7232  4/255 [..............................] - ETA: 4:07:36 - loss: 48.1910  5/255 [..............................] - ETA: 3:26:58 - loss: 41.8540  6/255 [..............................] - ETA: 2:54:02 - loss: 37.4365  7/255 [..............................] - ETA: 3:01:19 - loss: 34.0143  8/255 [..............................] - ETA: 2:39:16 - loss: 31.3097  9/255 [>.............................] - ETA: 2:22:13 - loss: 29.1231 10/255 [>.............................] - ETA: 2:08:07 - loss: 27.4573 11/255 [>.............................] - ETA: 1:57:26 - loss: 96457054.7794 12/255 [>.............................] - ETA: 1:48:18 - loss: 88418967.7671 13/255 [>.............................] - ETA: 1:48:02 - loss: 81617509.5268 14/255 [>.............................] - ETA: 1:40:27 - loss: 81449128.5606 15/255 [>.............................] - ETA: 1:34:14 - loss: 76019187.4859 16/255 [>.............................] - ETA: 1:28:34 - loss: inf           17/255 [=>............................] - ETA: 1:23:46 - loss: inf 18/255 [=>............................] - ETA: 1:19:31 - loss: inf 19/255 [=>............................] - ETA: 1:37:06 - loss: inf 20/255 [=>............................] - ETA: 1:38:47 - loss: inf 21/255 [=>............................] - ETA: 1:34:08 - loss: inf 22/255 [=>............................] - ETA: 1:29:59 - loss: inf 23/255 [=>............................] - ETA: 1:26:13 - loss: inf 24/255 [=>............................] - ETA: 1:39:25 - loss: inf 25/255 [=>............................] - ETA: 1:35:27 - loss: inf 26/255 [==>...........................] - ETA: 1:31:48 - loss: inf 27/255 [==>...........................] - ETA: 1:28:18 - loss: inf 28/255 [==>...........................] - ETA: 1:25:12 - loss: inf 29/255 [==>...........................] - ETA: 1:22:19 - loss: inf 30/255 [==>...........................] - ETA: 1:19:32 - loss: inf 31/255 [==>...........................] - ETA: 1:17:00 - loss: inf 32/255 [==>...........................] - ETA: 1:14:35 - loss: inf 33/255 [==>...........................] - ETA: 1:12:14 - loss: inf 34/255 [===>..........................] - ETA: 1:12:25 - loss: inf 35/255 [===>..........................] - ETA: 1:10:12 - loss: inf 36/255 [===>..........................] - ETA: 1:08:19 - loss: inf 37/255 [===>..........................] - ETA: 1:06:24 - loss: inf 38/255 [===>..........................] - ETA: 1:04:33 - loss: nan 39/255 [===>..........................] - ETA: 1:02:52 - loss: nan 40/255 [===>..........................] - ETA: 1:01:13 - loss: nan 41/255 [===>..........................] - ETA: 59:41 - loss: nan   42/255 [===>..........................] - ETA: 1:01:54 - loss: nan 43/255 [====>.........................] - ETA: 1:00:20 - loss: nan 44/255 [====>.........................] - ETA: 58:50 - loss: nan   45/255 [====>.........................] - ETA: 57:26 - loss: nan 46/255 [====>.........................] - ETA: 59:10 - loss: nan 47/255 [====>.........................] - ETA: 57:53 - loss: nan 48/255 [====>.........................] - ETA: 56:31 - loss: nan 49/255 [====>.........................] - ETA: 55:13 - loss: nan 50/255 [====>.........................] - ETA: 54:01 - loss: nan 51/255 [=====>........................] - ETA: 52:49 - loss: nan 52/255 [=====>........................] - ETA: 51:45 - loss: nan 53/255 [=====>........................] - ETA: 50:38 - loss: nan 54/255 [=====>........................] - ETA: 49:37 - loss: nan 55/255 [=====>........................] - ETA: 48:43 - loss: nan 56/255 [=====>........................] - ETA: 47:43 - loss: nan 57/255 [=====>........................] - ETA: 46:50 - loss: nan 58/255 [=====>........................] - ETA: 46:04 - loss: nan 59/255 [=====>........................] - ETA: 45:13 - loss: nan 60/255 [======>.......................] - ETA: 44:24 - loss: nan 61/255 [======>.......................] - ETA: 43:39 - loss: nan 62/255 [======>.......................] - ETA: 42:52 - loss: nan 63/255 [======>.......................] - ETA: 42:03 - loss: nan 64/255 [======>.......................] - ETA: 41:19 - loss: nan 65/255 [======>.......................] - ETA: 40:37 - loss: nan 66/255 [======>.......................] - ETA: 40:03 - loss: nan 67/255 [======>.......................] - ETA: 39:20 - loss: nan 68/255 [=======>......................] - ETA: 38:40 - loss: nan 69/255 [=======>......................] - ETA: 38:05 - loss: nan 70/255 [=======>......................] - ETA: 37:26 - loss: nan 71/255 [=======>......................] - ETA: 36:48 - loss: nan 72/255 [=======>......................] - ETA: 36:56 - loss: nan 73/255 [=======>......................] - ETA: 36:21 - loss: nan 74/255 [=======>......................] - ETA: 35:47 - loss: nan 75/255 [=======>......................] - ETA: 35:11 - loss: nan 76/255 [=======>......................] - ETA: 34:37 - loss: nan 77/255 [========>.....................] - ETA: 34:08 - loss: nan 78/255 [========>.....................] - ETA: 33:37 - loss: nan 79/255 [========>.....................] - ETA: 33:09 - loss: nan 80/255 [========>.....................] - ETA: 32:38 - loss: nan 81/255 [========>.....................] - ETA: 32:12 - loss: nan 82/255 [========>.....................] - ETA: 31:43 - loss: nan 83/255 [========>.....................] - ETA: 31:13 - loss: nan 84/255 [========>.....................] - ETA: 30:47 - loss: nan 85/255 [=========>....................] - ETA: 30:20 - loss: nan 86/255 [=========>....................] - ETA: 29:56 - loss: nan 87/255 [=========>....................] - ETA: 29:32 - loss: nan 88/255 [=========>....................] - ETA: 29:06 - loss: nan 89/255 [=========>....................] - ETA: 28:43 - loss: nan 90/255 [=========>....................] - ETA: 28:19 - loss: nan 91/255 [=========>....................] - ETA: 27:57 - loss: nan 92/255 [=========>....................] - ETA: 27:33 - loss: nan 93/255 [=========>....................] - ETA: 27:09 - loss: nan 94/255 [==========>...................] - ETA: 26:47 - loss: nan 95/255 [==========>...................] - ETA: 26:25 - loss: nan 96/255 [==========>...................] - ETA: 26:05 - loss: nan 97/255 [==========>...................] - ETA: 25:43 - loss: nan 98/255 [==========>...................] - ETA: 25:23 - loss: nan 99/255 [==========>...................] - ETA: 25:01 - loss: nan100/255 [==========>...................] - ETA: 24:40 - loss: nan101/255 [==========>...................] - ETA: 24:21 - loss: nan102/255 [===========>..................] - ETA: 24:00 - loss: nan103/255 [===========>..................] - ETA: 23:43 - loss: nan104/255 [===========>..................] - ETA: 23:23 - loss: nan105/255 [===========>..................] - ETA: 23:06 - loss: nan106/255 [===========>..................] - ETA: 22:47 - loss: nan107/255 [===========>..................] - ETA: 22:31 - loss: nan108/255 [===========>..................] - ETA: 22:14 - loss: nan109/255 [===========>..................] - ETA: 21:55 - loss: nan110/255 [===========>..................] - ETA: 21:39 - loss: nan111/255 [============>.................] - ETA: 21:21 - loss: nan112/255 [============>.................] - ETA: 21:04 - loss: nan113/255 [============>.................] - ETA: 20:46 - loss: nan114/255 [============>.................] - ETA: 20:29 - loss: nan115/255 [============>.................] - ETA: 20:13 - loss: nan116/255 [============>.................] - ETA: 19:56 - loss: nan117/255 [============>.................] - ETA: 19:41 - loss: nan118/255 [============>.................] - ETA: 19:25 - loss: nan119/255 [=============>................] - ETA: 19:11 - loss: nan120/255 [=============>................] - ETA: 18:57 - loss: nan121/255 [=============>................] - ETA: 18:43 - loss: nan122/255 [=============>................] - ETA: 18:28 - loss: nan123/255 [=============>................] - ETA: 18:17 - loss: nan124/255 [=============>................] - ETA: 18:02 - loss: nan125/255 [=============>................] - ETA: 17:48 - loss: nan126/255 [=============>................] - ETA: 17:34 - loss: nan127/255 [=============>................] - ETA: 17:22 - loss: nan128/255 [==============>...............] - ETA: 17:08 - loss: nan129/255 [==============>...............] - ETA: 16:56 - loss: nan130/255 [==============>...............] - ETA: 16:43 - loss: nan131/255 [==============>...............] - ETA: 16:29 - loss: nan132/255 [==============>...............] - ETA: 16:17 - loss: nan133/255 [==============>...............] - ETA: 16:04 - loss: nan134/255 [==============>...............] - ETA: 15:51 - loss: nan135/255 [==============>...............] - ETA: 15:38 - loss: nan136/255 [===============>..............] - ETA: 15:26 - loss: nan137/255 [===============>..............] - ETA: 15:13 - loss: nan138/255 [===============>..............] - ETA: 15:01 - loss: nan139/255 [===============>..............] - ETA: 14:50 - loss: nan140/255 [===============>..............] - ETA: 14:40 - loss: nan141/255 [===============>..............] - ETA: 14:28 - loss: nan142/255 [===============>..............] - ETA: 14:17 - loss: nan143/255 [===============>..............] - ETA: 14:05 - loss: nan144/255 [===============>..............] - ETA: 13:55 - loss: nan145/255 [================>.............] - ETA: 13:44 - loss: nan146/255 [================>.............] - ETA: 13:32 - loss: nan147/255 [================>.............] - ETA: 13:22 - loss: nan148/255 [================>.............] - ETA: 13:11 - loss: nan149/255 [================>.............] - ETA: 13:01 - loss: nan150/255 [================>.............] - ETA: 12:50 - loss: nan151/255 [================>.............] - ETA: 12:40 - loss: nan152/255 [================>.............] - ETA: 12:29 - loss: nan153/255 [=================>............] - ETA: 12:18 - loss: nan154/255 [=================>............] - ETA: 12:07 - loss: nan155/255 [=================>............] - ETA: 11:56 - loss: nan156/255 [=================>............] - ETA: 11:47 - loss: nan157/255 [=================>............] - ETA: 11:37 - loss: nan158/255 [=================>............] - ETA: 11:27 - loss: nan159/255 [=================>............] - ETA: 11:18 - loss: nan160/255 [=================>............] - ETA: 11:09 - loss: nan161/255 [=================>............] - ETA: 10:59 - loss: nan162/255 [==================>...........] - ETA: 10:50 - loss: nan163/255 [==================>...........] - ETA: 10:42 - loss: nan164/255 [==================>...........] - ETA: 10:33 - loss: nan165/255 [==================>...........] - ETA: 10:24 - loss: nan166/255 [==================>...........] - ETA: 10:15 - loss: nan167/255 [==================>...........] - ETA: 10:06 - loss: nan168/255 [==================>...........] - ETA: 10:04 - loss: nan169/255 [==================>...........] - ETA: 9:56 - loss: nan 170/255 [===================>..........] - ETA: 9:47 - loss: nan171/255 [===================>..........] - ETA: 9:38 - loss: nan172/255 [===================>..........] - ETA: 9:36 - loss: nan173/255 [===================>..........] - ETA: 9:27 - loss: nan174/255 [===================>..........] - ETA: 9:17 - loss: nan175/255 [===================>..........] - ETA: 9:08 - loss: nan176/255 [===================>..........] - ETA: 9:00 - loss: nan177/255 [===================>..........] - ETA: 8:52 - loss: nan178/255 [===================>..........] - ETA: 8:43 - loss: nan179/255 [====================>.........] - ETA: 8:34 - loss: nan180/255 [====================>.........] - ETA: 8:27 - loss: nan181/255 [====================>.........] - ETA: 8:19 - loss: nan182/255 [====================>.........] - ETA: 8:10 - loss: nan183/255 [====================>.........] - ETA: 8:01 - loss: nan184/255 [====================>.........] - ETA: 7:54 - loss: nan185/255 [====================>.........] - ETA: 7:45 - loss: nan186/255 [====================>.........] - ETA: 7:37 - loss: nan187/255 [=====================>........] - ETA: 7:29 - loss: nan188/255 [=====================>........] - ETA: 7:22 - loss: nan189/255 [=====================>........] - ETA: 7:14 - loss: nan190/255 [=====================>........] - ETA: 7:06 - loss: nanslurmstepd: error: *** JOB 4620150 ON tiger-i26c2n8 CANCELLED AT 2020-04-14T12:45:19 ***
